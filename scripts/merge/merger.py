import pandas as pd

exploitdb_df = pd.read_csv("../../data/exploitdb/separate.csv", dtype="string")
nvd_df = pd.read_csv("../../data/nvd/cves_nvd_parsed.csv", dtype="string")

print("Merging datasets")
final_df = nvd_df.merge(exploitdb_df, on="CVE", how="left")
print("Fixing false non-exploitable vulnerabilities in the NVD dump by cross-checking with ExploitDB")
for index, row in final_df.iterrows():
    # If I have a value for "Platform", which is contained in the ExploitDB dataset, I assume that specific CVE is exploitable. 
    if not pd.isnull(row["Platform"]):
        final_df.loc[index, 'exploitable'] = "TRUE" 
final_df.to_csv("../data/final.csv", index=False)
